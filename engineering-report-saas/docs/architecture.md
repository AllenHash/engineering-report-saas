# 系统架构设计文档

**版本**：1.0  
**日期**：2026-02-25  
**状态**：进行中

---

## 1. 系统架构图（待完善）

```
┌─────────────────────────────────────────────────────────────────┐
│                         用户端                                  │
│              （Web端 / 微信小程序 / H5）                         │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      接入层                                     │
│            （CDN加速 / HTTPS / WAF防护）                        │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      应用层 (后端服务)                           │
│                                                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │   用户模块   │  │   报告模块   │  │   积分模块   │              │
│  │  注册/登录   │  │  生成/导出   │  │  购买/消耗   │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
│                                                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │   模板模块   │  │   支付模块   │  │   消息模块   │              │
│  │  管理/选择   │  │  微信支付    │  │  通知/推送   │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      AI 服务层                                  │
│                                                                   │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│   │   GLM (智谱)  │  │  Qwen (阿里)  │  │DeepSeek (深度│         │
│   └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                   │
│   ┌──────────────────────────────────────────────────────────┐  │
│   │                    文本库（地理/气象/地质数据）            │  │
│   └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      数据层                                     │
│                                                                   │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│   │  PostgreSQL  │  │    Redis     │  │   对象存储    │         │
│   │   (主数据库)  │  │   (缓存)     │  │  (文件/图片)  │         │
│   └──────────────┘  └──────────────┘  └──────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 技术选型（待确认）

| 层级 | 技术方案 | 说明 |
|------|----------|------|
| **前端** | Vue3 / React / 微信小程序 | 待讨论 |
| **后端** | Python (FastAPI) | 高性能，易开发 |
| **数据库** | PostgreSQL | 成熟稳定 |
| **缓存** | Redis | Session/缓存 |
| **文件存储** | 阿里云OSS / 腾讯云COS | 图/片/文件存储 |
| **AI模型** | GLM / Qwen / DeepSeek | 国产大模型 |
| **部署** | Vercel (MVP阶段) | 免费，自带CDN，可绑定自定义域名 articly.chat |
| **后期迁移** | 可迁移到自建云服务器 | 阿里云/腾讯云 2核4G |

---

## 3. 部署架构（待讨论）

- 云服务器选择
- 容器化方案
- 扩展性设计

---

## 4. Multi-Agent 装配式架构

### 设计理念
采用模块化、装配式设计，参考 OpenClaw 的 Agent 架构思路：
- 接口标准化：所有 Agent 使用统一的通信协议
- 可插拔：随时替换/升级单个 Agent
- 可扩展：新增 Agent 不影响现有系统

### Agent 清单（MVP阶段）

| Agent | 数量 | 职责 |
|-------|------|------|
| 对话Agent | 1 | 主对话，引导用户，协调其他Agent |
| 信息提取Agent | 1 | 提取关键信息（名称、地点、投资等） |
| 生成Agent | 1 | 分章节生成报告内容 |
| 整合Agent | 1 | 把各章节整合成完整报告 |
| 格式Agent | 1 | Markdown转PDF |

### 工作流程
1. 用户对话 → 对话Agent接收
2. 信息提取Agent → 提取关键信息
3. 生成Agent → 分章节生成
4. 整合Agent → 汇总成完整报告
5. 格式Agent → 转换为PDF

### 扩展路线
- V1.0: + 资料处理Agent（处理上传的图片、Excel）
- V1.5: + 文本库增强Agent（提高准确性）
- V2.0: + 专业领域Agent（财务分析、环保评估等）

## 5. 安全设计（待讨论）

- 身份认证
- 数据加密
- 接口鉴权

---

*本文档将根据讨论持续更新*