# 工程可行性报告AI生成系统 - 开发任务清单

## 项目概述
工程可行性报告AI生成SaaS系统，帮助工程咨询工程师自动生成符合中国规范的工程可行性研究报告。

---

## 零、前端设计（最高优先级）

### 0.1 设计指南
- [x] **D-1** 创建设计指南文档 ✅ 已完成
  - 阅读减少AI感的设计方法
  - 创建 DESIGN_GUIDE.md

### 0.2 首页样式改进
- [x] **D-2** 应用新配色方案 ✅ 已完成
  - 深蓝黑背景 + 琥珀色强调
  - 使用CSS变量管理主题
- [x] **D-3** 图标替换 ✅ 已完成
  - 替换emoji为 lucide-react
  - 统一图标风格
- [x] **D-4** 动效优化 ✅ 已完成
  - 添加页面过渡效果
  - 按钮悬停动效
- [x] **D-5** 组件样式优化 ✅ 已完成
  - 卡片样式改进
  - 输入框样式改进
  - 按钮样式改进

### 0.3 其他页面设计
- [x] **D-6** 登录/注册页面设计 ✅ 已完成改进
- [x] **D-7** 报告编辑器页面设计 ✅ 已完成
- [x] **D-8** 个人中心页面设计 ✅ 已完成

---

## 一、MVP核心功能（P0）

### 1.1 数据库层
- [ ] **P0-1** 配置 Prisma 并创建数据库 schema
  - 创建 prisma/schema.prisma
  - 定义 User, Report, Project, Template, PointsTransaction 模型
  - 运行迁移命令创建数据库表
- [ ] **P0-2** 完善数据库操作函数 (src/lib/db.ts)
  - 实现用户、报告、积分等 CRUD 操作
  - 对接真实数据库（SQLite/PostgreSQL）

### 1.2 用户系统
- [x] **P0-3** 用户注册 API (/api/auth/register) ✅ 已完成
- [x] **P0-4** 用户登录 API (/api/auth/login) ✅ 已完成
- [x] **P0-5** 获取当前用户 API (/api/auth/me) ✅ 已完成
- [x] **P0-6** 积分系统 API (/api/points) ✅ 已完成
- [ ] **P0-7** 完善积分充值页面 (/profile/recharge)
  - 集成真实支付网关（支付宝/微信）
  - 充值后增加积分到数据库
- [ ] **P0-8** 完善积分历史页面 (/profile/history)
  - 从数据库获取真实积分变动记录

### 1.3 报告管理
- [x] **P0-9** 完善报告列表页面 (/reports) ✅ 已完成
  - 从数据库获取用户报告列表
  - 显示报告状态(草稿/生成中/已完成)
- [x] **P0-10** 创建报告创建流程 (/create) ✅ 已完成
  - 对话式交互收集项目信息
  - 项目名称、建设地点、工程类型、建设规模、投资估算
- [ ] **P0-11** 完善报告编辑器页面 (/editor/[id])
  - 连接数据库获取真实报告数据
  - 实现章节内容保存到数据库
- [ ] **P0-12** 实现报告保存 API
  - 保存/更新报告内容到数据库
  - 新增/重命名/删除章节

### 1.4 AI 生成系统
- [x] **P0-13** 对话 API (/api/chat) ✅ 已完成
- [x] **P0-14** 目录生成功能 ✅ 已完成（通过模板系统）
- [x] **P0-15** 报告生成 API (/api/reports/generate) ✅ 已完成
- [x] **P0-16** 内容生成 Agent ✅ 已完成
- [ ] **P0-17** 实现生成所有章节功能
  - 支持一键生成完整报告所有章节
  - 优化生成速度和并发处理

---

## 二、重要功能（P1）

### 2.1 导出功能
- [ ] **P1-1** 实现 PDF 导出功能
  - 集成 jspdf + html2canvas
  - 生成符合规范的工程报告格式
- [ ] **P1-2** 创建导出 API (/api/reports/export)
  - 支持 PDF/Word/Markdown 格式
- [ ] **P1-3** 报告预览页面
  - 实时预览报告效果

### 2.2 模板系统
- [x] **P1-4** 模板数据与 API ✅ 已完成
- [ ] **P1-5** 完善模板列表页面 (/templates)
  - 模板预览和搜索功能

### 2.3 关键信息联动
- [ ] **P1-6** 关键信息联动功能
  - 修改项目信息时自动更新受影响章节
  - 联动影响范围分析

### 2.4 用户体验优化
- [ ] **P1-7** 报告自动保存功能
  - 定时自动保存编辑内容
- [ ] **P1-8** AI 响应流式输出
  - 实现实时流式生成展示
- [ ] **P1-9** 进度条显示
  - 显示 AI 生成进度
- [ ] **P1-10** 完善错误提示
- [ ] **P1-11** API 请求重试机制

### 2.5 性能优化
- [ ] **P1-12** 实现报告内容缓存

---

## 三、优化完善期（P2）

### 3.1 报告版本管理
- [ ] **P2-1** 报告版本历史与回滚
- [ ] **P2-2** 多版本对比功能

### 3.2 管理后台（可选）
- [ ] **P2-3** 管理员登录入口
- [ ] **P2-4** 用户管理功能
- [ ] **P2-5** 营收统计

---

## 当前状态总结 (2026-02-27)

### ✅ 已完成
- 基础框架 (Next.js + Tailwind + TypeScript)
- 认证系统（邮箱注册/登录）
- 积分系统（API实现，需连接数据库）
- 首页三栏布局（项目列表+对话+右侧面板）
- 对话API与报告生成API
- 内容生成Agent
- 模板数据（9个行业模板）
- 报告编辑器页面框架

### ⚠️ 待完善
- 数据库层（Prisma + SQLite/PostgreSQL）
- 报告创建流程
- 报告编辑器数据库连接
- 支付网关集成
- 导出功能

### ❌ 待开发
- 关键信息联动
- 版本历史与回滚
- 自动保存

---

## 任务优先级说明
- **P0 (MVP)**: 必须完成，系统核心功能
- **P1**: 重要功能，提升用户体验
- **P2**: 次要功能，可后续迭代

---

## PRD已批准 (2026-02-27)
- MVP目标：邮箱注册、生成目录、生成所有章节、预览报告
- P0: 15项核心功能
- P1: 12项重要功能
- P2: 优化完善期（不增加新功能）
- 首页三栏布局 ✅ 已完成